import {
  PuckRichText
} from "./chunk-X63TCMG2.js";
import {
  styles_module_default
} from "./chunk-FVLWLOVM.js";
import {
  DOMParser,
  DOMSerializer,
  Node,
  getSchema
} from "./chunk-O7OUVIV2.js";
import {
  get_class_name_factory_default,
  init_react_import
} from "./chunk-7IAXJJJK.js";
import {
  require_jsx_runtime
} from "./chunk-VDCHTWZU.js";
import {
  __toESM,
  require_react
} from "./chunk-77YYOHSB.js";

// node_modules/@tiptap/html/dist/index.js
function getHTMLFromFragment(doc, schema, options) {
  if (typeof window === "undefined") {
    throw new Error(
      "getHTMLFromFragment can only be used in a browser environment\nIf you want to use this in a Node environment, use the `@tiptap/html/server` import instead."
    );
  }
  if (options == null ? void 0 : options.document) {
    const wrap = options.document.createElement("div");
    DOMSerializer.fromSchema(schema).serializeFragment(doc.content, { document: options.document }, wrap);
    return wrap.innerHTML;
  }
  const fragment = DOMSerializer.fromSchema(schema).serializeFragment(doc.content, {
    document: window.document
  });
  const serializer = new XMLSerializer();
  return serializer.serializeToString(fragment);
}
function generateHTML(doc, extensions) {
  if (typeof window === "undefined") {
    throw new Error(
      "generateHTML can only be used in a browser environment\nIf you want to use this in a Node environment, use the `@tiptap/html/server` import instead."
    );
  }
  const schema = getSchema(extensions);
  const contentNode = Node.fromJSON(schema, doc);
  return getHTMLFromFragment(contentNode, schema);
}
function generateJSON(html, extensions, options) {
  if (typeof window === "undefined") {
    throw new Error(
      "generateJSON can only be used in a browser environment\nIf you want to use this in a Node environment, use the `@tiptap/html/server` import instead."
    );
  }
  const schema = getSchema(extensions);
  const doc = new window.DOMParser().parseFromString(html, "text/html");
  if (!doc) {
    throw new Error("Failed to parse HTML string");
  }
  return DOMParser.fromSchema(schema).parse(doc.body, options).toJSON();
}

// node_modules/@puckeditor/core/dist/Render-CU35UAWV.mjs
var import_react = __toESM(require_react(), 1);
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
init_react_import();
var getClassName = get_class_name_factory_default("RichTextEditor", styles_module_default);
function RichTextRender({
  content,
  field
}) {
  const { tiptap = {}, options } = field;
  const { extensions = [] } = tiptap;
  const loadedExtensions = (0, import_react.useMemo)(
    () => [PuckRichText.configure(options), ...extensions],
    [field, extensions]
  );
  const normalized = (0, import_react.useMemo)(() => {
    if (typeof content === "object" && (content == null ? void 0 : content.type) === "doc") {
      return content;
    }
    if (typeof content === "string") {
      const isHtml = /<\/?[a-z][\s\S]*>/i.test(content);
      if (isHtml) {
        return generateJSON(content, loadedExtensions);
      }
      return {
        type: "doc",
        content: [
          { type: "paragraph", content: [{ type: "text", text: content }] }
        ]
      };
    }
    return { type: "doc", content: [] };
  }, [content, loadedExtensions]);
  const html = (0, import_react.useMemo)(() => {
    return generateHTML(normalized, loadedExtensions);
  }, [normalized, loadedExtensions]);
  return (0, import_jsx_runtime.jsx)("div", { className: getClassName(), children: (0, import_jsx_runtime.jsx)("div", { className: "rich-text", dangerouslySetInnerHTML: { __html: html } }) });
}
export {
  RichTextRender
};
//# sourceMappingURL=Render-CU35UAWV-NF7YNHHV.js.map
