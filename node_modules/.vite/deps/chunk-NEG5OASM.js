import {
  LoadedRichTextMenuInner
} from "./chunk-BVQJQYZX.js";
import {
  useAppStore,
  useAppStoreApi
} from "./chunk-BPEV6CY6.js";
import {
  styles_module_default
} from "./chunk-FVLWLOVM.js";
import {
  __spreadValues,
  get_class_name_factory_default,
  init_react_import
} from "./chunk-7IAXJJJK.js";
import {
  require_jsx_runtime
} from "./chunk-VDCHTWZU.js";
import {
  __toESM,
  require_react
} from "./chunk-77YYOHSB.js";

// node_modules/@puckeditor/core/dist/chunk-RHVK562Z.mjs
var import_react = __toESM(require_react(), 1);
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var import_react2 = __toESM(require_react(), 1);
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
init_react_import();
var getClassName = get_class_name_factory_default("RichTextEditor", styles_module_default);
var EditorInner = (0, import_react.memo)(
  ({
    children,
    menu,
    readOnly = false,
    field,
    inline = false,
    editor,
    id
  }) => {
    const { initialHeight } = field;
    const isActive = useAppStore(
      (s) => {
        var _a;
        return ((_a = s.currentRichText) == null ? void 0 : _a.id) === id && inline === s.currentRichText.inline;
      }
    );
    const appStoreApi = useAppStoreApi();
    const handleHotkeyCapture = (0, import_react.useCallback)(
      (event) => {
        var _a, _b;
        if ((event.metaKey || event.ctrlKey) && event.key.toLowerCase() === "i") {
          event.stopPropagation();
          event.preventDefault();
          (_b = editor == null ? void 0 : (_a = editor.commands).toggleItalic) == null ? void 0 : _b.call(_a);
        }
        if (event.key.toLowerCase() === "backspace") {
          event.stopPropagation();
        }
      },
      [editor]
    );
    const handleBlur = (0, import_react.useCallback)(
      (e2) => {
        var _a, _b;
        const targetInMenu = !!((_b = (_a = e2.relatedTarget) == null ? void 0 : _a.closest) == null ? void 0 : _b.call(
          _a,
          "[data-puck-rte-menu]"
        ));
        if (e2.relatedTarget && !targetInMenu) {
          appStoreApi.setState({
            currentRichText: null
          });
        } else {
          e2.stopPropagation();
        }
      },
      [appStoreApi]
    );
    return (0, import_jsx_runtime.jsxs)(
      "div",
      {
        className: getClassName({
          editor: !inline,
          inline,
          isActive,
          disabled: readOnly
        }),
        style: inline ? {} : { height: initialHeight != null ? initialHeight : 192, overflowY: "auto" },
        onKeyDownCapture: handleHotkeyCapture,
        onBlur: handleBlur,
        children: [
          !inline && (0, import_jsx_runtime.jsx)("div", { className: getClassName("menu"), children: menu }),
          children
        ]
      }
    );
  }
);
EditorInner.displayName = "EditorInner";
init_react_import();
var LoadedRichTextMenuFull = (0, import_react2.lazy)(
  () => import("./full-KLPRWVS4-MYLOJFGC.js").then((m) => ({
    default: m.LoadedRichTextMenuFull
  }))
);
var LoadedRichTextMenu = (props) => {
  return (0, import_jsx_runtime2.jsx)(import_react2.Suspense, { fallback: (0, import_jsx_runtime2.jsx)(LoadedRichTextMenuInner, __spreadValues({}, props)), children: (0, import_jsx_runtime2.jsx)(LoadedRichTextMenuFull, __spreadValues({}, props)) });
};

// node_modules/use-debounce/dist/index.module.js
var import_react3 = __toESM(require_react());
function c(u2, e2, c2) {
  var i2 = this, a2 = (0, import_react3.useRef)(null), o2 = (0, import_react3.useRef)(0), f = (0, import_react3.useRef)(null), l = (0, import_react3.useRef)([]), m = (0, import_react3.useRef)(), v = (0, import_react3.useRef)(), d = (0, import_react3.useRef)(u2), p = (0, import_react3.useRef)(true);
  (0, import_react3.useEffect)(function() {
    d.current = u2;
  }, [u2]);
  var g = !e2 && 0 !== e2 && "undefined" != typeof window;
  if ("function" != typeof u2) throw new TypeError("Expected a function");
  e2 = +e2 || 0;
  var w = !!(c2 = c2 || {}).leading, s = !("trailing" in c2) || !!c2.trailing, x = "maxWait" in c2, y = x ? Math.max(+c2.maxWait || 0, e2) : null;
  (0, import_react3.useEffect)(function() {
    return p.current = true, function() {
      p.current = false;
    };
  }, []);
  var h = (0, import_react3.useMemo)(function() {
    var r2 = function(r3) {
      var n3 = l.current, t3 = m.current;
      return l.current = m.current = null, o2.current = r3, v.current = d.current.apply(t3, n3);
    }, n2 = function(r3, n3) {
      g && cancelAnimationFrame(f.current), f.current = g ? requestAnimationFrame(r3) : setTimeout(r3, n3);
    }, t2 = function(r3) {
      if (!p.current) return false;
      var n3 = r3 - a2.current;
      return !a2.current || n3 >= e2 || n3 < 0 || x && r3 - o2.current >= y;
    }, u3 = function(n3) {
      return f.current = null, s && l.current ? r2(n3) : (l.current = m.current = null, v.current);
    }, c3 = function r3() {
      var c4 = Date.now();
      if (t2(c4)) return u3(c4);
      if (p.current) {
        var i3 = e2 - (c4 - a2.current), f2 = x ? Math.min(i3, y - (c4 - o2.current)) : i3;
        n2(r3, f2);
      }
    }, h2 = function() {
      var u4 = Date.now(), d2 = t2(u4);
      if (l.current = [].slice.call(arguments), m.current = i2, a2.current = u4, d2) {
        if (!f.current && p.current) return o2.current = a2.current, n2(c3, e2), w ? r2(a2.current) : v.current;
        if (x) return n2(c3, e2), r2(a2.current);
      }
      return f.current || n2(c3, e2), v.current;
    };
    return h2.cancel = function() {
      f.current && (g ? cancelAnimationFrame(f.current) : clearTimeout(f.current)), o2.current = 0, l.current = a2.current = m.current = f.current = null;
    }, h2.isPending = function() {
      return !!f.current;
    }, h2.flush = function() {
      return f.current ? u3(Date.now()) : v.current;
    }, h2;
  }, [w, x, e2, y, s, g]);
  return h;
}
function i(r2, n2) {
  return r2 === n2;
}
function a(r2) {
  return "function" == typeof r2 ? function() {
    return r2;
  } : r2;
}
function o(n2, t2, o2) {
  var f, l, m = o2 && o2.equalityFn || i, v = (f = (0, import_react3.useState)(a(n2)), l = f[1], [f[0], (0, import_react3.useCallback)(function(r2) {
    return l(a(r2));
  }, [])]), d = v[0], p = v[1], g = c((0, import_react3.useCallback)(function(r2) {
    return p(r2);
  }, [p]), t2, o2), w = (0, import_react3.useRef)(n2);
  return m(w.current, n2) || (g(n2), w.current = n2), [d, g];
}

export {
  EditorInner,
  LoadedRichTextMenu,
  c,
  o
};
//# sourceMappingURL=chunk-NEG5OASM.js.map
