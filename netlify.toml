[build]
  command = "npm install --legacy-peer-deps && npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "22"
  NPM_FLAGS = "--legacy-peer-deps"
  # These env vars are intentionally in the client bundle or source files.
  # SANITY_API_TOKEN: server-side only, never in client JS.
  # VITE_SANITY_DATASET / VITE_SANITY_PROJECT_ID: public Sanity config,
  # embedded by Vite into client JS by design (safe, not secrets).
  SECRETS_SCAN_OMIT_KEYS = "SANITY_API_TOKEN,VITE_SANITY_DATASET,VITE_SANITY_PROJECT_ID"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
